# 启动页（Splash）布局优化分析

基于当前 `src/ui/splash.ts` 与截图，对「弈笔草莽」启动页的布局与体验做可落地优化建议。

---

## 一、当前做得好的地方

1. **层级清晰**：主标题 36px 粗体 + 副标题 16px + 小标题 13px 粗体 + 正文 12px，字号与字重层次明确。
2. **【】小标题与正文左对齐**：小标题和段落正文都用 `g.x + pad` 起绘，【与段落首字左对齐一致。
3. **留白充足**：`guideArea` 内 `pad = 18`，段落间 `paragraphGap = 12`，整体不挤。
4. **呼吸动效**：「点击屏幕开始游戏」和「▼」用 `Math.sin(Date.now()/900)` 做透明度脉冲，有引导感。

---

## 二、可优化点与建议

### 1. 玩法指南区域高度与裁切（高优先级）

**现状**：`guideArea.height = Math.min(460, screenHeight * 0.62)` 固定上限 460px，且内容用 `ctx.clip()` 裁切，无滚动。

**问题**：
- 小屏或安全区大时，三块【意图即指令】【时空自演化】【结局由你定】可能被裁掉底部。
- 日后若增加段落或字号，同样会被裁切且无法查看。

**建议**：
- **方案 A**：根据实际绘制高度动态算 `guideArea.height`（先 measure 再布局），保证三块完整露出；若超出安全区域则改为「固定最大高度 + 内部滚动」。
- **方案 B**：至少保证当前三段在常见机型上不被裁：用 `lineHeight`、`paragraphGap` 和总行数估算最小需要高度，令 `guideArea.height = Math.max(估算高度, min(460, screenHeight * 0.62))`，或按比例缩小字号/段落间距以「塞进」当前区域。

### 2. 「点击开始」与「▼」的交互语义（中优先级）

**现状**：文案为「点击屏幕开始游戏」，下方为「▼」；`tapHintArea` 全屏可点。

**问题**：「点击」和向下箭头容易让人联想成「向下滑动」，实际是全屏点击进入。

**建议**：
- 文案改为「点击任意处开始」或「点击屏幕任意处开始游戏」，弱化「滑动」联想。
- 或保留「▼」但改为「点击」类图标（如手指/点击圈），或仅保留文字、去掉箭头，减少歧义。

### 3. 底部提示与安全区（中优先级）

**现状**：`hintY = layout.guideArea.y + layout.guideArea.height + 20`，未考虑底部安全区（Home 条、异形屏）。

**问题**：在带 Home 条或底部安全区较大的设备上，「点击屏幕开始游戏」可能贴边或被遮挡。

**建议**：在 `createSplashLayout` 中增加 `safeAreaBottom` 参数（与主游戏 layout 一致），计算 `hintY` 时预留底部安全区，例如：  
`hintY = screenHeight - safeAreaBottom - 60`（或根据标题区与 guide 区动态计算），保证提示始终在安全区内。

### 4. 段落间距与行高（低优先级）

**现状**：`lineHeight = 14`、`paragraphGap = 12`，小标题与上一段间隔 `4 + 2`。

**建议**：若希望阅读更松一点，可微调为 `lineHeight = 15`、`paragraphGap = 14`；小标题前间距可略增到 6～8，使块与块更易区分。若担心小屏空间，可仅增大 `paragraphGap`、保持行高。

### 5. 内容扩展与可维护性（低优先级）

**现状**：`guideLines` 为硬编码字符串数组，标题靠「以【开头且】结尾」判断样式。

**建议**：
- 若后续会增删段落，可把 `guideLines` 抽到 `src/config/` 或单独文案文件，便于运营修改。
- 若未来有 4～5 段以上，建议在 layout 中预留「指南区域可滚动」的设计（例如传入 scrollOffset，绘制时偏移 y），避免再次出现裁切问题。

### 6. 其他可选优化

- **无障碍**：若需支持系统字号放大，可对 `guideArea` 内字号做一次基于 `screenWidth` 或设备 fontScale 的缩放（例如 375 基准下 12px，小屏略减、大屏略增）。
- **背景**：当前渐变已足够简洁；若希望更有「历史感」，可在渐变上叠加一层极低透明度的纹理图或静态底图，不改变现有布局逻辑。

---

## 三、建议实施顺序

1. **先做**：底部提示安全区（`safeAreaBottom`）+ 文案/箭头语义优化，改动小、收益明确。
2. **其次**：确认各机型上三段玩法指南是否被裁切；若会裁切，再做动态高度或滚动。
3. **视需求**：段落间距/行高微调、文案外置、无障碍字号。

---

## 四、涉及文件

| 文件 | 修改点 |
|------|--------|
| `src/ui/splash.ts` | `createSplashLayout` 增加 `safeAreaBottom`；`guideArea.height` 或动态计算或与安全区协调；`renderSplash` 中 `hintY` 考虑安全区；可选：`guideLines` 文案与「点击」提示文案 |
| `src/app/gameApp.ts` | 调用 `createSplashLayout` 时传入 `safeAreaBottom`（与主 layout 一致） |

以上分析基于当前代码与截图，实施时可按优先级分步落地。

---

## 五、已实施的优化（按本文档落地）

- **底部提示安全区**：`createSplashLayout` 增加 `safeAreaBottom` 参数，`SplashLayout` 增加 `safeAreaBottom` 字段；`renderSplash` 中 `hintY = screenHeight - safeAreaBottom - HINT_BLOCK_HEIGHT + 18`，保证提示在安全区内。`gameApp` 初始化时传入 `systemInfo.safeAreaBottom`。
- **点击文案与箭头**：文案改为 `SPLASH_TAP_HINT`（「点击任意处开始」），去掉「▼」箭头，减少与「滑动」的歧义。
- **玩法指南区域高度**：`guideArea.height` 改为基于可用高度 `screenHeight - guideY - HINT_BLOCK_HEIGHT - safeAreaBottom`，并限制在 `[280, 460]`，避免与底部提示重叠并在小屏留出安全区。
- **段落间距与行高**：`lineHeight` 14→15，`paragraphGap` 12→14，小标题前间距 4→`sectionTitleGap` 8。
- **文案外置**：`guideLines` 抽到 `config/index.ts` 为 `SPLASH_GUIDE_LINES`，点击提示为 `SPLASH_TAP_HINT`，便于后续修改。
- **底部改为按钮+勾选**：去掉「点击任意处开始」文案，改为「开始游戏」按钮 + 勾选框 +「隐私和数据声明」链接；须勾选后才能开始，未勾选点按钮时 toast 提示；链接点击打开隐私弹窗。文案统一为「隐私和数据声明」。

---

## 六、当前版本（开始游戏按钮 + 勾选）布局可优化点

基于当前截图与 `splash.ts` 中「开始游戏」按钮 + 勾选 +「隐私和数据声明」的布局，可考虑以下优化。

### 1. 勾选行与按钮的视觉权重（中优先级）

**现状**：勾选框为小方框（20px），右侧「隐私和数据声明」为 12px accent 色；与上方的 44px 高「开始游戏」按钮相比，整行偏轻。  
**建议**：勾选行与按钮左边缘对齐；可适当增加勾选行与按钮的间距（如 `START_BTN_GAP` 从 12 调到 14～16）。若希望「必须勾选」更显眼，可将勾选行略微放大（如 `CHECKBOX_SIZE` 22px、链接 13px），提高可读与可点性。

### 2. 玩法指南区域与底部操作区（中优先级）

**现状**：`guideArea` 高度在 [280, 460] 由可用高度决定，底部固定「开始游戏」+ 勾选行。  
**建议**：在刘海屏/大安全区设备上确认三段玩法文案不被裁切；保证按钮与 guide 卡片底边有足够留白。

### 3. 「隐私和数据声明」链接的点击热区（高优先级）

**建议**：链接已用 `privacyLinkRect` 单独命中检测；若设备上感觉不好点，可略增 `privacyLinkRect.height` 或链接字号 12→13。可选：为链接加一条极细下划线（1px accent 0.8 透明），强化「可点击」感知。

### 4. 勾选框「已勾选」态（低优先级）

**建议**：对勾线条可略加粗或稍放大，在深色背景下更易辨认；保持与按钮一致的 accent 色。

### 5. 弹窗与首页文案统一（已完成）

弹窗标题、首页链接、toast 已统一为「隐私和数据声明」。

### 6. 已实施的优化（本节全部落地）

- **勾选行与按钮**：`START_BTN_GAP` 12→16；`CHECKBOX_SIZE` 20→22；`CHECKBOX_ROW_HEIGHT` 28→30；`START_SECTION_HEIGHT` 88→94，保证与 guide 底边留白。
- **隐私链接**：链接字号 12→13；`privacyLinkRect` 高度随 `CHECKBOX_ROW_HEIGHT` 增至 30；增加 1px accent 0.8 透明下划线，强化可点击感知。
- **勾选已勾选态**：对勾 `lineWidth` 2→2.5，勾尺寸 `s` 4→5，`lineJoin = "round"`，深色背景下更易辨认。
