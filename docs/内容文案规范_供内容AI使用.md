# 内容文案规范（供内容 AI 使用）

本文档是**唯一**授权你编写/修改的内容范围与格式说明。工程侧会按此规范接入你的产出，请严格按以下约定执行，避免写完后无法直接使用。

---

## 一、你的职责与禁止项

### 1.1 你只负责

- **纯文本内容**：世界观设定、开场白、系统提示词、界面按钮/标签/提示语、审核失败提示、fallback 叙事句等。
- **展示用名称**：NPC 的 `name`、存档的 `saveName` 等**面向玩家显示**的字符串。
- **不修改**：任何逻辑、字段名、接口、文件名、路径、数字（如武力 75）、枚举 key（如 `region: "yingchuan"` 的 `yingchuan`）、代码结构。

### 1.2 你禁止

- 修改或删除 TypeScript 的**类型、接口、函数签名、import、文件名、目录结构**。
- 修改**字段名**（如 `dialogueHistory`、`saveName`、`player_intent`）和**枚举/常量 key**（如 `PROMPT_KEYS.SYSTEM`、`region` 的取值 `yingchuan`）。
- 编写或注入任何可执行代码（如 `eval`、`Function`、脚本）。
- 在文案中插入未转义的双引号、反斜杠、换行符等导致 JSON/TS 字符串语法错误的字符；若必须换行，使用 `\n`（在 TS 字符串内）。

### 1.3 通用格式要求

- **编码**：UTF-8。
- **语言**：游戏内面向玩家的文案一律使用**简体中文**（除非产品另有说明）。
- **长度**：单条文案尽量控制在 200 字以内（界面按钮/标签 2～8 字）；System Prompt 可更长，但建议不超过 4000 字，以便接口与成本可控。
- **风格**：与项目设定一致（当前为三国背景、古风叙事）；系统提示可偏现代，但需统一。

---

## 二、按文件与位置逐项规范

以下每个条目对应工程中的**确切位置**。你只需按「条目 ID」提供或修改**字符串内容**，不要改字段名或代码结构。

---

### 2.1 开局与默认存档文案（两处必须一致）

以下两处内容必须**完全相同**（工程侧可能会抽成单一数据源，你只需提供一份，并注明「用于 INITIAL_DIALOGUE 与 createDefaultSave 的 dialogueHistory」）。

**位置 1**：`src/app.ts` 中的常量 `INITIAL_DIALOGUE`  
**位置 2**：`src/services/storage/saveManager.ts` 中函数 `createDefaultSave()` 返回对象里的 `dialogueHistory` 数组。

- **类型**：字符串数组，`string[]`。
- **条数**：建议 3～5 条，每条一句，按剧情顺序。
- **用途**：玩家首次进入游戏或新开档时显示的旁白/引导。
- **当前示例**（可替换为你的文案，保持格式）：
  ```ts
  [
    "中平元年（公元184年），你醒来发现自己身处洛阳城外的小村庄。",
    "村中长者告诉你，黄巾之乱已然爆发，天下将乱。",
    "你可以选择投靠官府，也可以暗中结交豪杰，甚至加入太平道……"
  ]
  ```

**交付格式**：直接给出与上面结构相同的数组内容（可写进 TS 文件片段或 JSON 数组），并注明「开局旁白，共 N 条」。

---

### 2.2 默认世界与 NPC 的「展示用」文案

**文件**：`src/config/index.ts`。

你可修改的**仅限**以下字段的**字符串值**（不得改字段名或类型）：

| 字段路径 | 类型 | 说明 | 约束 |
|----------|------|------|------|
| `DEFAULT_WORLD_STATE.era` | string | 时代标识，可用于显示 | 建议简短，如 "184" 或 "建宁" |
| `DEFAULT_NPC_STATE[].name` | string | NPC 显示名 | 中文名，如 "曹操"、"刘备" |
| （若未来增加）地区/场景的显示名 | - | 仅当工程侧增加对应字段时你才填写 | 以工程侧说明为准 |

**禁止修改**：  
- `DEFAULT_PLAYER_STATE` 下所有**数字**（attrs、legend、reputation、resources）及 `id`、`tags`、`location.region`、`location.scene`。  
- `DEFAULT_WORLD_STATE` 的 `flags`、`time`、`regionStatus` 的 **key**（如 `jingzhou`、`yuzhou`）；你可建议 `regionStatus` 的 **value** 展示文案（若工程改为展示用）。  
- `DEFAULT_NPC_STATE[].id`、`stance`、`trust`、`location`（这些为逻辑用标识，不能改为中文长句）。

**交付格式**：列出要改的键路径与替换后的字符串值；若只改 NPC 名字，直接给出 `id` 与 `name` 对应表即可。

---

### 2.3 LLM 用 System Prompt（系统提示词）

**文件**：`src/agents/prompts.ts`。  
**用法**：通过 `registerPrompt(PROMPT_KEYS.SYSTEM, "你的完整 System Prompt 文案")` 注册；**key 固定为 `PROMPT_KEYS.SYSTEM`（值为 "system"）**，你只提供第二个参数的**整段字符串**。

- **类型**：单个长字符串，可包含多段，用 `\n` 换行。
- **内容要求**：  
  - 明确时代与世界观（如三国、年份、势力）。  
  - 规定叙事口吻（如古风旁白、第二人称）。  
  - 规定输出格式（如先叙事再效果）。  
  - 禁止 LLM 脱离设定或输出违规内容。
- **当前占位**：`"占位 System Prompt：请保持古风旁白，后续由内容团队提供正式文案。"`

**交付格式**：直接给出**完整的一段或多段 System Prompt 正文**（可先 Markdown，工程侧会转成单字符串放入 `registerPrompt`）。若分多段，请注明顺序（从上到下为 1、2、3…）。

---

### 2.4 其他 Prompt 键（可选）

**文件**：`src/agents/prompts.ts`。  
当前已定义的 key：`PROMPT_KEYS.SAFETY`（"safety"）、`PROMPT_KEYS.NEW_PLAYER`（"new_player"）。若工程侧已接入，你会收到说明；否则只需先完成 SYSTEM。  
**交付格式**：若需提供，格式同 2.3，并注明对应的 key（如 `safety` / `new_player`）。

---

### 2.5 主流程中的固定话术（app.ts）

**文件**：`src/app.ts`。  
以下为**唯一**需要你提供或修改的字符串及其出现位置（不要改变量名或逻辑）：

| 序号 | 用途说明 | 当前示例/位置 | 建议长度 |
|------|----------|----------------|----------|
| A1 | 帮助指令回复（多句可写成数组，工程按数组逐条展示） | `【指令提示】你可以直接输入"存档""读档""你是谁""广告"等基础命令，无需调用裁决。` | 1～3 句 |
| A2 | 读档成功提示 | `【提示】最新存档已加载。` | 一句 |
| A3 | 读档无存档提示 | `【提示】暂无可用存档。` | 一句 |
| A4 | 「你是谁」回复 | `我是一名负责主持冒险的军机参谋，随时记录你的每一次抉择。` | 1～2 句 |
| A5 | 「广告」指令提示 | `广告加载中，完成观看可获得额外资源奖励。` | 一句 |
| A6 | 等待裁决时的占位句 | `（等待裁决结果...）` | 短句 |
| A7 | 游戏已保存提示 | `【游戏已保存】` | 短句 |
| A8 | 网络异常提示 | `网络波动，请稍后重试 (点击输入框重试)` | 一句 |
| A9 | 裁决/生成内容不可用时的 fallback | `内容暂时不可用` | 短句 |
| A10 | 叙事 fallback（裁决无 narrative 时） | `你的举动引起了注意。` | 一句 |
| A11 | 模拟裁决 fallback（本地模拟时用的旁白） | `你的举动引起了县尉的注意，他对你的行为表示赞赏。` | 一句 |
| A12 | 安全审核未通过时的默认提示（仅当未用 contentGuard 的 reason 时） | `输入未通过安全审核` | 短句 |
| A13 | 退出小游戏不支持时的提示 | `【提示】当前环境不支持直接退出，请关闭小游戏窗口。` | 一句 |
| A14 | 手动存档时的存档名（传入 createNewSave 的第二个参数） | `手动存档` | 2～6 字 |
| A15 | 初始存档时的存档名（同上） | `初始存档` | 2～6 字 |

**交付格式**：按序号（A1～A15）列出「序号 + 替换后的完整字符串」。若某条不修改，可写「A2：保持现状」。

---

### 2.6 存档相关默认名称（saveManager.ts）

**文件**：`src/services/storage/saveManager.ts`。

| 序号 | 位置 | 用途 | 当前值 | 约束 |
|------|------|------|--------|------|
| S1 | `createDefaultSave()` 返回的 `meta.saveName` | 默认存档的显示名 | `默认存档` | 2～8 字 |
| S2 | `createNewSave(slot, saveName)` 的默认参数 `saveName` | 新建存档时的默认名称 | `新建存档` | 2～8 字 |

**交付格式**：列出 S1、S2 的最终字符串；若不改则写「保持现状」。

---

### 2.7 安全与审核提示（contentGuard.ts）

**文件**：`src/services/security/contentGuard.ts`。  
以下为 `reason` 对用户展示的文案，你可改写语气，但**不得删除或合并分支**（工程按 `reason` 区分逻辑）。

| 序号 | 触发场景 | 当前文案 | 约束 |
|------|----------|----------|------|
| G1 | 输入为空 | `请输入有效内容` | 短句 |
| G2 | 命中本地敏感词 | `输入内容涉及敏感词，已被拦截` | 短句 |
| G3 | 平台审核不通过（玩家输入） | `内容未通过平台审核，请调整后再试` | 短句 |
| G4 | 生成内容命中敏感词 | `生成内容包含敏感信息，已自动屏蔽` | 短句 |
| G5 | 生成内容平台审核不通过 | `生成内容未通过审核，已替换为系统回复` | 短句 |

**交付格式**：按 G1～G5 列出替换后的字符串。

---

### 2.8 界面文案（renderer.ts）

**文件**：`src/ui/renderer.ts`。  
以下为 Canvas 上绘制的**固定中文**，你只改引号内的字符串，不要改变量名、`fillText` 的坐标或逻辑。

| 序号 | 位置/用途 | 当前文案 | 约束 |
|------|-----------|----------|------|
| R1 | 属性面板标题 | `玩家属性` | 2～6 字 |
| R2 | 属性行前缀（共 5 条，顺序不可改） | `武力`、`智力`、`魅力`、`运气`、`传奇度` | 各 2～4 字 |
| R3 | 状态：已存档 | `已存档` | 2～4 字 |
| R4 | 状态：新游戏 | `新游戏` | 2～4 字 |
| R5 | 属性区按钮 | `存档` | 2～4 字 |
| R6 | 控制栏按钮 | `个人信息`、`设置`、`退出` | 各 2～6 字 |
| R7 | 控制栏提示（无存档时） | `提示: 完成第一次存档后可解锁更多面板功能` | 一句 |
| R8 | 对话区溢出提示 | `（更多内容...）` | 短句 |
| R9 | 输入框占位（未聚焦） | `点击此处输入你的意图...` | 一句 |
| R10 | 输入框占位（输入中） | `输入中...` | 2～6 字 |
| R11 | 发送按钮 | `发送` | 2 字 |
| R12 | 自动保存提示 | `自动保存已启用` | 短句 |
| R13 | 存档面板标题 | `存档管理` | 2～6 字 |
| R14 | 存档面板按钮 | `保存游戏`、`关闭面板` | 各 2～6 字 |
| R15 | 无存档时提示 | `无存档数据，请先保存游戏` | 一句 |
| R16 | 角色档案浮层标题 | `角色档案` | 2～6 字 |
| R17 | 无存档时档案提示 | `暂无存档数据，完成一次冒险以解锁个人档案。` | 一句 |
| R18 | 系统设置浮层标题 | `系统设置` | 2～6 字 |
| R19 | 系统设置说明第 1 条 | `• 计划中的功能：音量调节、自动广告开关、快速退出等。` | 一句 |
| R20 | 系统设置说明第 2 条 | `• 当前版本聚焦剧情体验，后续将逐步开放更多设置项。` | 一句 |

**交付格式**：按 R1～R20 列出「序号 + 替换后的完整字符串」。若某条不修改，写「R3：保持现状」。

**注意**：存档面板内动态行（如 `存档: ${meta.saveName}`、`玩家: ...`、`时间: ...`）的**前缀**「存档」「玩家」「时间」若需改为其它用语，请单独列出并注明「存档面板动态行前缀」。

---

## 三、交付物总览与检查清单

### 3.1 建议交付物列表（你交出一份文档或若干片段即可）

1. **开局旁白**：一份 `string[]`（3～5 条），注明用于 INITIAL_DIALOGUE 与 createDefaultSave.dialogueHistory。
2. **世界观/配置展示文案**：config 中可改的 era、NPC name 等（按 2.2 的表格列出）。
3. **System Prompt**：完整正文，注明 key 为 `system`。
4. **app 固定话术**：A1～A15 的最终文案（按 2.5 表格）。
5. **存档默认名称**：S1、S2（按 2.6）。
6. **安全审核提示**：G1～G5（按 2.7）。
7. **界面文案**：R1～R20（及存档面板前缀若有）（按 2.8）。

### 3.2 自检清单（交稿前请逐项确认）

- [ ] 所有字符串均未包含未转义的双引号 `"`、反斜杠 `\`（若在 TS 中需写成 `\"`、`\\`）。
- [ ] 开局旁白在两处（app 与 saveManager）完全一致（若工程已抽成单源，则只提供一份）。
- [ ] 未改任何字段名、枚举 key、数字（如武力 75）、文件名或路径。
- [ ] System Prompt 为单段或多段连续文本，总长建议 ≤4000 字。
- [ ] 界面按钮/标签类文案在 2～8 字内，符合 UI 显示空间。

---

## 四、版本与修订

- 文档版本：1.0。  
- 若工程侧新增条目（如新 Prompt key、新界面文案），会在此文档中追加「2.x 节」或表格行，并注明「新增」。你只需按新条目补充，无需重写已有部分。

完成以上内容后，工程侧会直接或通过脚本将你的文案接入对应文件；若某条你未提供，将保持现有文案不变。
